version: '3'
services:
  mongo:
    image: mongo:4.4.3-bionic
    container_name: ${MONGO}

  knowrob-init:
    image: iaik4r/knowrob-init:v0.2
    environment:
      - KNOWROB_MONGODB_PKG_URI=${KNOWROB_MONGODB_PKG_URI}
    entrypoint: /entrypoint.bash
    container_name: ${KNOWROB_INIT}
    
  knowrob:
    image: iaik4r/knowrob:v0.2
    container_name: ${KNOWROB}
    depends_on:
      - 'mongo'
    environment:
      - KNOWROB_VERSION=${KNOWROB_VERSION}
      - KNOWROB_PORT=${KNOWROB_PORT}
      - KNOWROB_MONGODB_URI=${KNOWROB_MONGODB_URI}
    ports:
      - "${KNOWROB_PORT}:${KNOWROB_PORT}"
    entrypoint: /entrypoint.bash
    command: roslaunch knowrob_k4r knowrob_k4r.launch
